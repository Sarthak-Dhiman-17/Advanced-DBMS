

CREATE TABLE Employee1 (
    ID INT,
    NAME VARCHAR(50),
    SALARY INT,
    DEPT_NAME VARCHAR(20),
    JOINING_DATE DATE
);

-- Insert records with random JOINING_DATE values
INSERT INTO Employee1 VALUES (1, 'AKASH', 25000, 'IT', '2021-05-14');
INSERT INTO Employee1 VALUES (2, 'VIKAS', 5000, 'SALES', '2022-08-01');
INSERT INTO Employee1 VALUES (3, 'ANAY', 5000, 'IT', '2020-11-23');
INSERT INTO Employee1 VALUES (4, 'ADITYA', 51000, 'SALES', '2023-03-10');
INSERT INTO Employee1 VALUES (5, 'RAVI', 6000, 'IT', '2021-09-17');
INSERT INTO Employee1 VALUES (6, 'ANUJ', 7000, 'SALES', '2020-07-05');
INSERT INTO Employee1 VALUES (7, 'DEEP', 21000, 'IT', '2022-02-25');
INSERT INTO Employee1 VALUES (8, 'NISHA', 52000, 'SALES', '2023-12-19');
INSERT INTO Employee1 VALUES (9, 'KARAN', 18000, 'HR', '2022-06-08');
INSERT INTO Employee1 VALUES (10, 'SNEHA', 35000, 'IT', '2023-01-12');
INSERT INTO Employee1 VALUES (11, 'MOHIT', 27000, 'MARKETING', '2021-03-19');
INSERT INTO Employee1 VALUES (12, 'RIYA', 40000, 'HR', '2020-10-28');
INSERT INTO Employee1 VALUES (13, 'AMAN', 15000, 'MARKETING', '2022-11-05');


select * from Employee1 order by JOINING_DATE desc

with cte as (
select ID, NAME, SALARY, DEPT_NAME, 
ROW_NUMBER() OVER(PARTITION BY DEPT_NAME ORDER BY JOINING_DATE desc) as temp
from Employee1
)
select ID, NAME, SALARY, DEPT_NAME from cte where temp between 1 and 2
